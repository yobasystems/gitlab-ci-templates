gitleaks:
  stage: test
  image: gitleaks/gitleaks:8.18.2
  allow_failure: true
  tags:
    - security
  script:
    - gitleaks detect --source="$CI_PROJECT_DIR" --report-format json --report-path gl-secret-detection-report.json --verbose
  artifacts:
    paths:
      - gl-secret-detection-report.json
    reports:
      secret_detection: gl-secret-detection-report.json
